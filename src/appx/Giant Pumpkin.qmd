---
title: "Giant Pumpkin"
---
```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(stringr)
```

```{r}
# Get the Data

# Read in with tidytuesdayR package 
# Install from CRAN via: install.packages("tidytuesdayR")
# This loads the readme and all the datasets for the week of interest

# Either ISO-8601 date or year/week works!

tuesdata <- tidytuesdayR::tt_load('2021-10-19')
tuesdata <- tidytuesdayR::tt_load(2021, week = 43)

pumpkins <- tuesdata$pumpkins

# Or read in the data manually

pumpkins <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2021/2021-10-19/pumpkins.csv')
```

```{r}
str(pumpkins)
```

```{r}
#Overall Weight Distribution
pumpkins$weight_lbs <- as.numeric(pumpkins$weight_lbs)
ggplot(pumpkins, aes(x = weight_lbs)) +
  geom_histogram(fill = "orange", color = "black", bins = 20) +
  labs(
    title = "Distribution of Pumpkin Weights",
    x = "Weight (lbs)",
    y = "Count",
    caption = "Data Source: The Great Pumpkin Commonwealth (GPC) in 2021 from BigPumpkins.com by Leah Zhang"
  ) +
  theme_minimal()
```

```{r}
#Weight Distribution by Place
pumpl <- df %>%
  mutate(
    weight_lbs   = as.numeric(weight_lbs),
    pct_chart    = as.numeric(pct_chart),
    place_clean  = parse_number(place)             # safer conversion
  ) %>%
  # drop rows where place is missing or zero after parsing
  filter(!is.na(place_clean) & place_clean > 0) %>%
  mutate(
    place_group = case_when(
      place_clean <= 5  ~ "1–5",
      place_clean <= 10 ~ "6–10",
      TRUE              ~ ">10"
    ),
    pct_quartile = ntile(pct_chart, 4),
    pct_quartile = factor(pct_quartile,
                          levels = 1:4,
                          labels = c("Q1 (lowest)", "Q2", "Q3", "Q4 (highest)"))
  )

# Boxplot by place group
ggplot(df2, aes(x = place_group, y = weight_lbs)) +
  geom_boxplot(outlier.size = 0.5) +
  labs(
    x     = "Place Group",
    y     = "Pumpkin Weight (lbs)",
    title = "Weight Distribution by Place Group"
  ) +
  theme_minimal(base_size = 14)


